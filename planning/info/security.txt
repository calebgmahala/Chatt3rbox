Security:
+-----------------------+------+------------------+----------------+------------------------+----------+
|        Actions        | user | user in chatroom | friend of user | admin user of chatroom | non-user |
+=======================+======+==================+================+========================+==========+
| Sign up               | X    | X                | X              | X                      | O        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Read any user         | O    | O                | O              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Update user           | O    | O                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Destroy user          | O    | O                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Login                 | O    | O                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Send friend request   | O    | O                | X              | O                      | X        |
| to user               |      |                  |                |                        |          |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Accept friend request | O    | O                | O              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Destroy friend link   | O    | O                | O              | O                      | x        |
| of user               |      |                  |                |                        |          |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Create chatroom       | O    | O                | O              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Read chatroom         | X    | O                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Update chatroom       | X    | X                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Destroy chatroom      | X    | X                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Join chatroom         | O    | X                | O              | X                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Notify a user         | X    | X                | O              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Block a user          | O    | O                | O              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Unblock A user        | O    | X                | X              | X                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Read messages from    | X    | X                | O              | X                      | X        |
| blocked user          |      |                  |                |                        |          |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Create messages       | O    | O                | O              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Read messages         | O    | O                | O              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Update messages       | O    | O                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+
| Delete messages       | O    | O                | X              | O                      | X        |
+-----------------------+------+------------------+----------------+------------------------+----------+